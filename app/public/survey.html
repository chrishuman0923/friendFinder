<!DOCTYPE html>
<html>
    <head>
        <meta id="viewport" content="width=device-width, initial-scale=1.0"/>

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
        <!-- Glyphicons -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

        <title>FriendFinder</title>
    </head>
    <body>
        </div>
        <div class="container">
            <h1 class="display-4">
                Survey
            </h1>
            <hr class="my-4">
            <h2>
                About You
            </h2>
            <form>
                <div class="form-group">
                    <label for="name" required="true">Name (Required)</label>
                    <input type="text" class="form-control" id="name">
                </div>
                <div class="form-group">
                    <label for="photo">Link to Photo Image (Required)</label>
                    <input type="text" class="form-control" id="photo">
                </div>
                <hr class="my-4">
                <h2>
                    Questions
                </h2>
                <div class="form-group">
                    <label for="question1">1. Your mind is always buzzing with unexplored ideas and plans.</label>
                    <select class="form-control" id="question1">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="question2">2. Generally speaking, you rely more on your experience than your imagination.</label>
                    <select class="form-control" id="question2">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="question3">3. You find it easy to stay relaxed and focused even when there is some pressure.</label>
                    <select class="form-control" id="question3">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="question4">4. You rarely do something just out of sheer curiosity.</label>
                    <select class="form-control" id="question4">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>  
                <div class="form-group">
                    <label for="question5">5. People can rarely upset you.</label>
                    <select class="form-control" id="question5">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="question6">6. It is often difficult for you to relate to other people’s feelings.</label>
                    <select class="form-control" id="question6">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="question7">7. In a discussion, truth should be more important than people’s sensitivities.</label>
                    <select class="form-control" id="question7">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="question8">8. You rarely get carried away by fantasies and ideas.</label>
                    <select class="form-control" id="question8">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="question9">9. You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</label>
                    <select class="form-control" id="question9">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="question10">10. You feel more energetic after spending time with a group of people.</label>
                    <select class="form-control" id="question10">
                        <option>Select an option</option>
                        <option>1 (Strongly Disagree)</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5 (Strongly Agree)</option>
                    </select>
                </div>
                <hr class="my-4">
                <button class="btn btn-primary btn-lg" id="submitBtn">
                        <span class="glyphicon glyphicon-ok-sign"></span> Submit
                </button>
            </form>
            <hr class="my-4">
            <footer>
                <a href="api/friends" target="_blank">API Friends List</a>
                 | 
                <a href="https://github.com/chrishuman0923/friendFinder" target="_blank">GitHub Repo</a>
            </footer>
        </div>
        <!-- Modal -->
        <div class="modal" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Friend Match</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Your closest match is <span id="matchName"></span>.</p>
                    <img id="matchPhoto" src="#" alt="Match Image" width="200" height="200"/>
                </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- JQuery CDN -->
        <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
        

        <!-- Custom JS to Handle Post -->
        <script>
            function validateForm() {
                event.preventDefault();

                if ($('#name').val().trim() === '') {
                    alert('Enter a name');
                } else if ($('#photo').val().trim() === '') {
                    alert('Enter a path to a photo.');
                } else if ($('select').val() === 'Select an option') {
                    alert('Complete all questions.');
                } else {
                    //Add form data to new object
                    var newEntry = {
                        name: $('#name').val().trim(),
                        photo: $('#photo').val().trim(),
                        scores: []
                    };

                    //Loop through questions and add score to scores array in object
                    $('select').each(function() {
                        newEntry.scores.push($(this).val());
                    });

                    submitData(newEntry);
                }
            }

            //Submit data via ajax post
            function submitData(entry) {
                $.post('/api/friends', entry, function(data) {
                    //Clear form
                    $('input').val('');
                    $('select').val('');
                    
                    //Update modal
                    $('#matchName').html(data.name);
                    $('#matchPhoto').src('src', data.photo);

                    //Keeps modal from displaying and then the image changing
                    setTimeout($('#exampleModal').modal('show'), 2000);
                });
            }

            //Add click handler
            $('#submitBtn').on('click', validateForm);
        </script>
    </body>
</html>